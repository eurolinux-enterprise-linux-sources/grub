diff --git a/efi/efidisk.c b/efi/efidisk.c
index 001ad89..a55a63b 100644
--- a/efi/efidisk.c
+++ b/efi/efidisk.c
@@ -529,7 +529,11 @@ grub_get_drive_partition_from_bdev_handle (grub_efi_handle_t handle,
   if (! dp)
     return 0;
 
-  dp1 = dp;
+  dp1 = duplicate_device_path(dp);
+  if (! dp1)
+    return 0;
+
+  dp = dp1;
   while (1)
     {
       grub_efi_uint8_t type = GRUB_EFI_DEVICE_PATH_TYPE (dp1);
