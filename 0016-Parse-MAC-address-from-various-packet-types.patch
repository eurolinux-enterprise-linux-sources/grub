diff --git a/efi/pxe.c b/efi/pxe.c
index d23a5de..dc0523f 100644
--- a/efi/pxe.c
+++ b/efi/pxe.c
@@ -150,11 +150,46 @@ static int get_dhcpv6_client_id(EFI_PXE_BASE_CODE_DHCPV6_PACKET *packet, uuid_t
 			continue;
 
 		memcpy(data, option->Data, ntohs(option->Length));
+
 		if (data[0] != 0)
 			continue;
 
-		memcpy(uuid, data+1, 16);
-		return 1;
+		if (data[1] == 1) {
+			/*
+			* DUID-LLT
+			* ------
+			* identifier type     = 2 bytes
+			* hardware type       = 2 bytes
+			* time                = 4 bytes
+			* link-layer address  = 6 bytes
+			*/
+			memcpy(uuid->node, data+8, 6);
+			return 1;
+		} else if (data[1] == 3) {
+			/*
+			* DUID-LL
+			* ------
+			* identifier type      = 2 bytes
+			* hardware type        = 2 bytes
+			* link-layer address   = 6 bytes
+			*/
+			memcpy(uuid->node, data+4, 6);
+			return 3;
+		} else if (data[1] == 4) {
+			/*
+			* DUID-UUID
+			* ---------
+			* identifier type        = 2 bytes
+			* time-low               = 4 bytes
+			* time-mid               = 2 bytes
+			* time-high-and-version  = 2 bytes
+			* clock-seq-and-reserver = 1 byte
+			* clock-seq-low          = 1 byte
+			* link-layer address     = 6 bytes
+			*/
+			memcpy(uuid, data+2, 16);
+			return 4;
+		}
 	}
 	return 0;
 }
@@ -641,8 +676,9 @@ static char *grub_efi_pxe_get_config_pathv6(EFI_PXE_BASE_CODE *pxe, grub_efi_loa
 	char mac[21];
 	grub_efi_uintn_t FileSize = 0;
 	char hex[] = "0123456789ABCDEF";
+	int clientIdResult = get_dhcpv6_client_id(packet, &uuid);
 
-	if (get_dhcpv6_client_id(packet, &uuid)) {
+	if (clientIdResult == 4) {
 		FileName = grub_malloc(strlen("1902dcf5-7190-d811-bbd6-6ef21c690030"));
 		uuid.time_mid = 0x0011;
 		sprintf(FileName,
@@ -661,7 +697,9 @@ static char *grub_efi_pxe_get_config_pathv6(EFI_PXE_BASE_CODE *pxe, grub_efi_loa
 			//sprintf(tftp_info.LastPath, FileName);
 			return ReturnFile;
 		}
+	}
 
+	if (clientIdResult != 0) {
 		/*
 		 * If the whole client id doesn't work, Just try it with the node portion, 
 		 * which should be the hw address (note the DHCPv6 ACK packet doesn't contain a
-- 


